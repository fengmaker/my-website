这是 CVRP 精确算法演变史的第二章节。

在第一阶段，我们发现直接照搬 TSP 的 GCC 约束虽然逻辑正确，但**“松弛下界太弱”**。求解器很容易用 $x=0.5$ 或 $x=0.33$ 这种“分数欺骗”来满足容量需求，却不支付相应的车辆成本。

为了整治这种“偷工减料”，学界在 1990 年代到 2004 年间，发起了一场名为**“割平面军备竞赛”**的运动。这一阶段的目标非常明确：**不仅要切掉不连通的解（像 TSP 那样），还要切掉那些“装不下”的解（像背包问题那样）。**

这一阶段的集大成者是 **Lysgaard, Letchford, Eglese (2004)** 的算法，它代表了基于边（Edge-based）模型的最高水平。

---

# CVRP 第二阶段：割平面的巅峰与装箱逻辑

**Phase 2: Advanced Branch-and-Cut & The Packing Logic**

## 1. 核心战术转变：从 Routing 到 Packing

CVRP = TSP (路线) + Bin Packing (装箱)。

第一阶段失败是因为太关注 TSP 部分。第二阶段，数学家们开始引入装箱多面体 (Knapsack Polytope) 的理论来加强模型。

### 1.1 什么是“分数欺骗”？(回顾)

假设容量 $Q=10$，客户 A 需求 $d=4$，客户 B 需求 $d=4$，客户 C 需求 $d=3$。总需求 11。

- **物理事实**：一辆车装不下 (11 > 10)，必须派 2 辆车。
    
- **LP 松弛解**：求解器可能会让 $x_{ij}$ 形成一个大圈，但每条边的流量打折。它可能只支付 1.1 辆车的成本（通过 $x$ 变量的微妙组合），而不是 2 辆车。
    

我们的任务是：找到一种不等式，**强迫** $x$ 变量反映出“货物很重，必须加车”的事实。

---

## 2. 核武器一：框架容量割 (Framed Capacity Cuts, FCC)

这是 CVRP 特有的割平面，专门用来解决“容量装不下”的问题。

### 2.1 构造逻辑

想象我们在地图上画了两个不相交的圈：

- **骨架集 (Frame, $F$)**：一个较大的客户集合。
    
- **填充集 (Bin, $S$)**：一个必须紧密连接的子集。
    

FCC 的数学推导非常复杂（涉及背包多面体的面定义），但其物理直觉如下：

如果 $S$ 里的货物很难装（比如都是大件，导致装箱效率低），那么为了服务这些点，需要的车辆数可能比单纯按重量计算的 $\lceil \sum d / Q \rceil$ 还要多。FCC 利用这种**“空隙率”**（Waste）来切掉那些过于理想化的 LP 解。

**效果**：它能切掉那些“虽然总重量没超，但因为货物形状（大小）原因装不进去”的分数解。

---

## 3. 核武器二：强化梳状不等式 (Strengthened Comb Cuts)

TSP 中的梳状不等式（Comb Inequalities）只能处理奇偶性（连通性）。

在 CVRP 中，Lysgaard 等人发现：容量会改变拓扑结构。

### 3.1 梳子的变异

在 TSP 中，梳齿 $T_i$ 只要与梳把 $H$ 相交即可。

在 CVRP 中，如果梳齿 $T_i$ 里的需求量很大（比如 $d(T_i) > Q$），这意味着一辆车根本搞不定这个梳齿。

强化逻辑：

普通的 TSP 梳状不等式假设每个齿只需进出 1 次（2 条边）。

CVRP 的强化梳状不等式通过计算 $r(T_i)$（梳齿的车辆需求下界），修改了不等式的右端项 (RHS)。

$$x(E(H)) + \sum x(E(T_i)) \le \text{New\_Bound}(H, T_i, Q)$$

这使得我们可以切掉那些**“连通性满足，但每辆车载重都超标”**的分数环。

---

## 4. 核武器三：多星不等式 (Multistar Cuts)

这是针对**局部放射状结构**的切割。

### 4.1 场景

考虑一个中心点（比如仓库或大客户），周围围着一圈小客户。

如果车从中心点出发，去服务周围的点。

- **TSP 逻辑**：去一个回一个，或者是穿成一串。
    
- **CVRP 逻辑**：如果周围的点需求很零散，车辆可能需要频繁往返中心点（像星星的光芒一样放射）。
    

**Multistar Cuts** 强制规定：

$$\text{连接中心点与外围点的边数} \le \text{基于容量计算的上限}$$

它专门用来打击那些“试图用一辆车串联所有小客户”的贪婪 LP 解，强迫求解器把路径打散，形成放射状（即多辆车）。

---

## 5. 这一阶段的巅峰与终结：Lysgaard (2004)

2004 年，Lysgaard 整合了上述所有割平面，发布了当时最强的 CVRP 求解算法。

### 5.1 战绩

- 它成功求解了许多之前悬而未决的 Benchmark 算例。
    
- **规模极限**：大约能稳定求解 **$N = 100 \sim 135$** 的问题。
    

### 5.2 为什么停在这里？(The Wall)

为什么 TSP 能解 8 万个点，CVRP 到了 100 多个点就死活上不去了？

原因在于**边（Edge）模型的基因缺陷**：

1. 分离太难 (Hard Separation)：
    
    TSP 的 Min-Cut 是多项式时间的。
    
    CVRP 的 Capacity Cut 分离是 NP-Hard 的（实际上是一个子集和问题）。要找到最紧的那个割平面，就像在解一个个小背包问题，非常耗时。
    
2. 下界松弛的极限：
    
    无论你怎么加 FCC 或 Multistar 割平面，你依然是在修补一个**“不擅长表达装箱”**的模型（双下标流模型）。
    
    这就像试图用补丁把一个气球修成一个方盒子，无论打多少补丁，它总有圆滑（松弛）的地方。
    

历史的转折点：

学界意识到，如果不换掉“基于边 ($x_{ij}$)”的底层逻辑，CVRP 永远解不了大规模问题。

我们必须寻找一种天然能表达“装箱”的模型。

于是，列生成 (Column Generation) 和 集合划分模型 (Set Partitioning) 终于要登场了。

这就是第三阶段的序幕。这一段关于“割平面军备竞赛”的逻辑清楚吗？如果可以，我们就进入那个改变一切的“路径视角”时代。